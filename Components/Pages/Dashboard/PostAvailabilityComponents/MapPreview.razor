@* MapPreview Component *@

<div class="bg-white rounded-xl sm:rounded-2xl overflow-hidden border-2 border-gray-200 shadow-lg">
	<div class="bg-gray-900 text-white px-4 sm:px-6 py-3 sm:py-4">
		<h3 class="font-bold text-base sm:text-lg flex items-center gap-2">
			<span>üó∫Ô∏è</span>
			<span>Route Preview</span>
		</h3>
	</div>
	<div class="relative w-full h-[300px] sm:h-[400px] lg:h-[500px]">
		<iframe
			src="@GetMapUrl()"
			width="100%"
			height="100%"
			style="border: 0"
			allowfullscreen
			loading="lazy"
			referrerpolicy="no-referrer-when-downgrade"
			title="Route Map"></iframe>
	</div>

	@if (!string.IsNullOrWhiteSpace(Origin) && !string.IsNullOrWhiteSpace(Destination))
	{
		<div class="p-4 sm:p-6 bg-gray-50 border-t-2 border-gray-200">
			<div class="space-y-3 sm:space-y-4">
				<div class="flex items-center gap-3">
					<div class="w-4 h-4 bg-teal-600 rounded-full flex-shrink-0"></div>
					<div class="flex-1">
						<p class="text-xs text-gray-500 font-semibold">Pickup Location</p>
						<p class="text-gray-900 font-bold text-sm sm:text-base">@Origin</p>
					</div>
				</div>
				<div class="ml-2 border-l-2 border-dashed border-gray-300 h-6 sm:h-8"></div>
				<div class="flex items-center gap-3">
					<div class="w-4 h-4 bg-blue-600 rounded-full flex-shrink-0"></div>
					<div class="flex-1">
						<p class="text-xs text-gray-500 font-semibold">Delivery Location</p>
						<p class="text-gray-900 font-bold text-sm sm:text-base">@Destination</p>
					</div>
				</div>
			</div>
		</div>
	}
</div>

@code {
	[Parameter] public string Origin { get; set; } = "";
	[Parameter] public string Destination { get; set; } = "";

	private string GetMapUrl()
	{
		if (!string.IsNullOrWhiteSpace(Origin) && !string.IsNullOrWhiteSpace(Destination))
		{
			var encodedOrigin = Uri.EscapeDataString(Origin);
			var encodedDestination = Uri.EscapeDataString(Destination);
			return $"https://www.google.com/maps/embed/v1/directions?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&origin={encodedOrigin}&destination={encodedDestination}&mode=driving";
		}
		return "https://www.google.com/maps/embed/v1/view?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&center=39.8283,-98.5795&zoom=4";
	}
}
